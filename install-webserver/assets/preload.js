"use strict";var r=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var f=Object.getOwnPropertyNames;var E=Object.prototype.hasOwnProperty;var M=(e,n,i,s)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of f(n))!E.call(e,t)&&t!==i&&r(e,t,{get:()=>n[t],enumerable:!(s=S(n,t))||s.enumerable});return e};var b=e=>M(r({},"__esModule",{value:!0}),e);var P={};module.exports=b(P);var l=require("electron"),o=(e,n)=>l.ipcRenderer.sendSync(e,n),g=()=>o("SLACKMOD_GET_PLUGINS"),u=()=>o("SLACKMOD_GET_THEMES"),d=(e,n)=>l.ipcRenderer.sendSync("SLACKMOD_GET_FILE",{pluginId:e,filePath:n}),m=e=>e?l.ipcRenderer.sendSync("SLACKMOD_GET_PLUGIN_CODE",e):{code:null,css:null},T=e=>l.ipcRenderer.sendSync("SLACKMOD_GET_THEME_CSS",e),L=(e,n)=>{let i=new Blob([e],{type:"text/javascript"}),s=URL.createObjectURL(i),t=document.createElement("script");t.src=s,t.onload=()=>{try{URL.revokeObjectURL(s)}catch{}t.removeAttribute("src")},t.setAttribute("data-slackmod",n),(document.head||document.documentElement).appendChild(t)},c=(e,n)=>{let i=document.createElement("style");i.setAttribute("data-slackmod",n),i.textContent=e,document.head.appendChild(i)},_=e=>{let n=m(e.id);return n?(n.css&&c(n.css,`plugin-${e.id}-style`),n.code&&L(n.code,`plugin-${e.id}`),{id:e.id,manifest:e.manifest}):null},h=e=>{let n=T(e);n&&c(n,`theme-${e}-style`)};l.contextBridge.exposeInMainWorld("slackmod_custom",{getPluginList:g,getPluginFile:m,enablePlugin:e=>o("SLACKMOD_ENABLE_PLUGIN",e),disablePlugin:e=>o("SLACKMOD_DISABLE_PLUGIN",e),getThemeList:u,enableTheme:e=>o("SLACKMOD_ENABLE_THEME",e),disableTheme:e=>o("SLACKMOD_DISABLE_THEME",e)});window.addEventListener("DOMContentLoaded",()=>{let e=d(null,"plugin-manager.js");e&&L(e,"plugin-manager");let n=d(null,"plugin-manager.css");n&&c(n,"plugin-manager-style");let i=g(),s=u();console.log(`[SlackMod] Found ${s.length} themes.`),s.forEach(t=>{t.enabled&&h(t.id)}),console.log(`[SlackMod] Found ${i.length} plugins.`),i.forEach(t=>{if(t.enabled){let a=_(t);console.log(a?`[SlackMod] Loaded plugin: ${a.id}`:`[SlackMod] Failed to load plugin: ${t.id}`)}})});
